define(["util","canvasclock","jquery","highcharts"],function(e,t,a,c){function d(){r.onclick=function(){e.addFavorite(window.location.href,"查酷导航")},i.onclick=function(){e.setHome(this,window.location.href)},window.onscroll=function(){var t=document.getElementsByTagName("header")[0],a=document.getElementById("rtt"),c=document.body.scrollTop;c>0?(e.addClass(t,"shadowed"),e.removeClass(a,"hide")):(e.removeClass(t,"shadowed"),e.addClass(a,"hide"))},a("#search_stock").click(function(){var e=a("#stock_code").val();""!=e&&e.match(/\d{6}/)?o(e):alert("请正确输出6位数字的股票代码!")}),a("#stock_code").keydown(function(e){var t=e.which;13==t&&a("#search_stock").click()})}function o(e){var t=new Date,a=t.getFullYear();s({el:"#stock_chart_1",startdate:a+"-1-1",enddate:a+"-12-31",code:e}),s({el:"#stock_chart_2",startdate:a-1+"-1-1",enddate:a-1+"-12-31",code:e}),s({el:"#stock_chart_3",startdate:a-2+"-1-1",enddate:a-2+"-12-31",code:e}),s({el:"#stock_chart_4",startdate:a-3+"-1-1",enddate:a-3+"-12-31",code:e}),s({el:"#stock_chart_5",startdate:a-4+"-1-1",enddate:a-4+"-12-31",code:e}),s({el:"#stock_chart_6",startdate:a-5+"-1-1",enddate:a-5+"-12-31",code:e}),s({el:"#stock_chart_7",startdate:a-6+"-1-1",enddate:a-6+"-12-31",code:e}),s({el:"#stock_chart_8",startdate:a-7+"-1-1",enddate:a-7+"-12-31",code:e}),s({el:"#stock_chart_9",startdate:a-8+"-1-1",enddate:a-8+"-12-31",code:e}),s({el:"#stock_chart_10",startdate:a-9+"-1-1",enddate:a-9+"-12-31",code:e})}function s(e){var t={el:"#stock_chart_1",categories:[],data:[],code:"000001",startdate:"2016-1-1",enddate:"2016-12-31"};e=a.extend({},t,e);var c=e.code;"000001"!=e.code?e.code="600"==e.code.substr(0,3)?e.code+".ss":e.code+".sz":e.code=e.code+".ss";try{a.ajax({url:"http://zenfa.cn/stock.php?stockname="+e.code+"&startdate="+e.startdate+"&enddate="+e.enddate,type:"GET",dataType:"json",error:function(t){var d="",o={};t.responseText&&(d=t.responseText.replace("<!-- Hosting24 Analytics Code -->","").replace('<script type="text/javascript" src="http://stats.hosting24.com/count.php"></script>',"").replace("<!-- End Of Analytics Code -->","").replace("\n","")),d=a.trim(d),o=JSON.parse(d);for(var s in o)e.categories.unshift(o[s].Date),e.data.unshift(parseFloat(o[s].Close));a(e.el).highcharts({chart:{type:"spline"},title:{text:e.startdate.split("-")[0]+"年 股票代码:"+c},xAxis:{categories:e.categories,gridLineWidth:1,endOnTick:!0},legend:{align:"center",verticalAlign:"top",x:0,y:20},yAxis:[{title:{text:"当前值",align:"high",margin:5},gridLineWidth:1,minRange:1}],tooltip:{crosshairs:!0,shared:!0},series:[{name:"当前值",yAxis:0,data:e.data,lineColor:"#ef6865",color:"#ef6865",lineWidth:1.5}],credits:{enabled:!1}})}})}catch(d){console.log(d.message)}}var n=document.getElementById("clock"),r=document.getElementById("addfav"),i=document.getElementById("sethome");return{init:function(){e.initClock(n),d(),o("000001")}}});